name: rust-toy-app
on: [push, pull_request]
jobs:
  build:
    env:
      BUILD_PROFILE: debug
    strategy:
      matrix:
        include:
          - runner: ubuntu-latest
            target: x86_64-unknown-linux-gnu
          - runner: ubuntu-latest
            target: aarch64-unknown-linux-gnu
          - runner: ubuntu-latest
            target: x86_64-unknown-freebsd
          - runner: ubuntu-latest
            target: aarch64-unknown-freebsd
          - runner: ubuntu-latest
            target: x86_64-unknown-openbsd
          - runner: ubuntu-latest
            target: aarch64-unknown-openbsd
          - runner: macos-latest
            target: x86_64-apple-darwin
          - runner: macos-latest
            target: aarch64-apple-darwin
          - runner: windows-latest
            target: x86_64-pc-windows-msvc
          - runner: windows-latest
            target: aarch64-pc-windows-msvc
    runs-on: ${{ matrix.runner }}
    steps:
      - name: Checkout repository
        uses: actions/checkout@08eba0b27e820071cde6df949e0beb9ba4906955
      - name: Setup Rust toolchain
        uses: ./.github/actions/setup-rust
        with:
          toolchain: 1.89.0
      - name: Build
        if: contains(matrix.target, 'linux')
        run: cargo build --target ${{ matrix.target }} --locked --manifest-path rust-toy-app/Cargo.toml
      - name: Skip non-Linux targets
        if: "!contains(matrix.target, 'linux')"
        run: echo "Skipping build for ${{ matrix.target }}"
