name: rust-toy-app
on: [push, pull_request]
jobs:
  build:
    strategy:
      matrix:
        include:
          - runner: ubuntu-latest
            target: x86_64-unknown-linux-gnu
          - runner: ubuntu-latest
            target: aarch64-unknown-linux-gnu
          - runner: ubuntu-latest
            target: x86_64-unknown-freebsd
          - runner: ubuntu-latest
            target: aarch64-unknown-freebsd
          - runner: ubuntu-latest
            target: x86_64-unknown-openbsd
          - runner: ubuntu-latest
            target: aarch64-unknown-openbsd
          - runner: macos-latest
            target: x86_64-apple-darwin
          - runner: macos-latest
            target: aarch64-apple-darwin
          - runner: windows-latest
            target: x86_64-pc-windows-msvc
          - runner: windows-latest
            target: aarch64-pc-windows-msvc
    runs-on: ${{ matrix.runner }}
    steps:
      - name: Checkout repository
        uses: actions/checkout@08eba0b27e820071cde6df949e0beb9ba4906955
      - name: Setup Rust toolchain
        uses: dtolnay/rust-toolchain@351f82a4dc29e4159746a068ed925da17341219f
        with:
          toolchain: 1.89.0
      - name: Cache cargo
        uses: Swatinem/rust-cache@7939da402645ba29a2df566723491a2c856e8f8a
      - name: Build
        if: contains(matrix.target, 'linux')
        run: cargo build --target ${{ matrix.target }} --locked --manifest-path rust-toy-app/Cargo.toml
      - name: Skip non-Linux targets
        if: "!contains(matrix.target, 'linux')"
        run: echo "Skipping build for ${{ matrix.target }}"
